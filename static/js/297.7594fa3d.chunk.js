"use strict";(self.webpackChunkreact_developer_way_blogging=self.webpackChunkreact_developer_way_blogging||[]).push([[297],{8322:function(e,t,n){n(2791);var r=n(184);t.Z=function(e){var t=e.title,n=void 0===t?"":t,a=e.desc,s=void 0===a?"":a,i=e.children;return(0,r.jsxs)("div",{className:"flex items-start justify-between mb-10",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-semibold dashboard-heading",children:n}),(0,r.jsx)("p",{className:"dashboard-short-desc",children:s})]}),i]})}},297:function(e,t,n){n.r(t);var r=n(1413),a=n(5861),s=n(885),i=n(7757),c=n.n(i),o=n(9062),l=n(2791),u=n(1134),d=n(6871),p=n(102),h=n(9254),m=n(9501),f=n(5639),x=n(3117),g=n(4954),v=n(4961),j=n(5208),b=n(1453),y=n(1776),w=n(3585),k=n(8322),Z=(n(6009),n(577)),N=n(6770),E=n.n(N),C=n(8113),I=n(4569),_=n.n(I),D=n(1665),S=n(1830),U=n.n(S),F=n(7531),P=n(333),A=n.n(P),J=n(184);N.Quill.register("modules/imageUploader",C.Z);t.default=function(){var e=(0,D.a)().userInfo,t=(0,d.TH)().state.id,n=(0,l.useState)(""),i=(0,s.Z)(n,2),N=i[0],C=i[1],I=(0,d.s0)(),S=(0,u.cI)({mode:"onChange",defaultValues:{}}),P=S.handleSubmit,L=S.control,T=S.watch,R=S.setValue,V=S.getValues,O=S.reset,Y=S.formState,M=Y.isValid,Q=Y.isSubmitting;(0,l.useEffect)((function(){function e(){return(e=(0,a.Z)(c().mark((function e(){var n,r,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=(0,o.JU)(b.F,"posts",t),e.next=5,(0,o.QT)(n);case 5:(r=e.sent).data()&&(O(r.data()),C((null===(a=r.data())||void 0===a?void 0:a.content)||""),ue((null===(s=r.data())||void 0===s?void 0:s.category)||""));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,O]);var G=V("image"),H=V("image_name"),q=(0,y.Z)(R,V,H,(function(){return ee.apply(this,arguments)})),z=q.image,B=q.progress,K=q.setImage,W=q.handleSelectImage,X=q.handleDeleteImage,$=q.handleResetUpload;function ee(){return(ee=(0,a.Z)(c().mark((function n(){var r;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((null===e||void 0===e?void 0:e.role)===w.xZ.ADMIN){n.next=3;break}return U().fire("Failed","You have no right to do this action","warning"),n.abrupt("return");case 3:return r=(0,o.JU)(b.F,"posts",t),n.next=6,(0,o.r7)(r,{image:""});case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}(0,l.useEffect)((function(){K(G)}),[K,G]);var te=T("hot"),ne=T("status"),re=(0,l.useState)([]),ae=(0,s.Z)(re,2),se=ae[0],ie=ae[1],ce=(0,l.useState)(""),oe=(0,s.Z)(ce,2),le=oe[0],ue=oe[1];(0,l.useEffect)((function(){function e(){return(e=(0,a.Z)(c().mark((function e(){var t,n,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,o.hJ)(b.F,"categories"),n=(0,o.IO)(t,(0,o.ar)("status","==",1)),e.next=4,(0,o.PL)(n);case 4:a=e.sent,s=[],a.forEach((function(e){s.push((0,r.Z)({id:e.id},e.data()))})),ie(s);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var de=function(){var e=(0,a.Z)(c().mark((function e(t){var n,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.JU)(b.F,"posts",t.id),e.next=3,(0,o.QT)(n);case 3:a=e.sent,R("category",(0,r.Z)({id:a.id},a.data())),ue(t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){document.title="Sneaker Blogging - Update post "}),[]);var pe=function(){var e=(0,a.Z)(c().mark((function e(n){var a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(M){e.next=2;break}return e.abrupt("return",null);case 2:return(a=(0,r.Z)({},n)).status=Number(n.status),a.slug=A()(n.slug||n.title,{lower:!0}),e.prev=5,s=(0,o.JU)(b.F,"posts",t),e.next=9,(0,o.r7)(s,(0,r.Z)((0,r.Z)({},a),{},{categoryId:a.category.id,content:N,image:z}));case 9:$(),Z.Am.success("Update user successfully"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(5),console.log(e.t0),Z.Am.error("Can not update user");case 17:$(),O({title:"",slug:"",status:2,category:{},hot:!1,image:"",user:{}}),C({}),ue({}),I("/manage/post");case 22:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t){return e.apply(this,arguments)}}(),he=(0,l.useMemo)((function(){return{toolbar:[["bold","italic","underline","strike"],["blockquote"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{header:[1,2,3,4,5,6,!1]}],["link","image"]],imageUploader:{upload:function(){var e=(0,a.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("image",t),e.next=4,_()({method:"post",url:"https://api.imgbb.com/1/upload?key=4bb6d43216f3a1e39a2b5d82fa69eeb1",data:n,headers:{"Content-Type":"mutipart/form-data"}});case 4:return r=e.sent,e.abrupt("return",r.data.data.url);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}}),[]);return t?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(k.Z,{title:"Update post",desc:"Your update post id: ".concat(t)}),(0,J.jsxs)("form",{onSubmit:P(pe),children:[(0,J.jsx)("div",{className:"grid mb-5 sm:grid-cols-1 lg:grid-cols-1 lg:gap-x-10 lg:mb-10",children:(0,J.jsxs)(f.g,{children:[(0,J.jsx)(g._,{children:"Image"}),(0,J.jsx)(j.Z,{onChange:W,className:" h-[400px]",progress:B,image:z,handleDeleteImage:X})]})}),(0,J.jsxs)("div",{className:"form-layout",children:[(0,J.jsxs)(f.g,{children:[(0,J.jsx)(g._,{children:"Title"}),(0,J.jsx)(x.I,{name:"title",control:L,placeholder:"Enter your title"})]}),(0,J.jsxs)(f.g,{children:[(0,J.jsx)(g._,{children:"Category"}),(0,J.jsxs)(m.L,{children:[(0,J.jsx)(m.L.Select,{placeholder:"".concat((null===le||void 0===le?void 0:le.name)||"Select at Categoris")}),(0,J.jsx)(m.L.List,{children:se.length>0&&se.map((function(e){return(0,J.jsx)(m.L.Option,{onClick:function(){return de(e)},children:e.name},e.id)}))})]})]})]}),(0,J.jsx)("div",{className:"w-full my-10",children:(0,J.jsxs)(f.g,{children:[(0,J.jsx)(g._,{children:"Description"}),(0,J.jsx)(F.Z,{name:"desc",control:L,placeholder:"Enter your description",className:"h-[100px]"})]})}),(0,J.jsxs)("div",{className:"my-10",children:[(0,J.jsx)(g._,{children:"Content"}),(0,J.jsx)("div",{className:"w-full entry-content",children:(0,J.jsx)(E(),{modules:he,theme:"snow",value:N,onChange:C})})]}),(0,J.jsxs)("div",{className:"form-layout",children:[(0,J.jsxs)(f.g,{children:[(0,J.jsx)(g._,{children:"Feature Hot"}),(0,J.jsx)(v.Z,{on:!0===te,onClick:function(){return R("hot",!te)}})]}),((null===e||void 0===e?void 0:e.role)===w.xZ.ADMIN||(null===e||void 0===e?void 0:e.role)===w.xZ.MOD)&&(0,J.jsxs)(f.g,{children:[(0,J.jsx)(g._,{children:"Status"}),(0,J.jsxs)("div",{className:"flex items-center gap-x-5",children:[(0,J.jsx)(h.Y,{name:"status",control:L,checked:Number(ne)===w.cf.APPROVED,value:w.cf.APPROVED,children:"Approved"}),(0,J.jsx)(h.Y,{name:"status",control:L,checked:Number(ne)===w.cf.PENDING,value:w.cf.PENDING,children:"Pending"}),(0,J.jsx)(h.Y,{name:"status",control:L,checked:Number(ne)===w.cf.REJECTED,value:w.cf.REJECTED,children:"Reject"})]})]})]}),(0,J.jsx)(p.z,{type:"submit",className:"mx-auto w-[250px]",isLoading:Q,disabled:Q,children:"Update post"})]})]}):null}}}]);
//# sourceMappingURL=297.7594fa3d.chunk.js.map